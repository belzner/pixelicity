<!DOCTYPE html>
<html>
	<head>
		{% load staticfiles %}
		<link rel="stylesheet" type="text/css" href="{% static "index.css" %}" />
		<script type="text/javascript" src="{% static "jquery-1.10.2.js" %}"></script>
		<script type="text/javascript" src="{% static "jquery.plugins.js" %}"></script>
		<script type="text/javascript" src="{% static "jquery-ui-1.10.3.custom.js" %}"></script>
		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCt8jX0GcgBNxSkh3_i-VuHQ8dW1fqbTg4&sensor=true">
		</script>
		<script type="text/javascript">
			function initialize() {
				var mapOptions = {
					center: new google.maps.LatLng(42.358, -71.094),
					zoom: 14,
					disableDefaultUI: true
				};
				var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
				{% if user.is_authenticated %}
					{% for loc in locations %}
						var imageBounds = new google.maps.LatLngBounds(
							new google.maps.LatLng({{ loc.centerLat }}-0.0003, {{ loc.centerLng }}-0.00045),
							new google.maps.LatLng({{ loc.centerLat }}+0.0004, {{ loc.centerLng }}+0.00045)
						);
						var overlay{{ forloop.counter }} = new google.maps.GroundOverlay('{% static loc.locImage %}', imageBounds);
						overlay{{ forloop.counter }}.setMap(map);
					{% endfor %}
				{% endif %}
			}
			google.maps.event.addDomListener(window, 'load', initialize);
			/*function getLocation() {
				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(
						function (position) {
							var userLatLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
							var marker = new google.maps.Marker({
								position: userLatLng,
								title: "Test"
							});
							marker.setMap(map);
							$(".mayr-talk span").html("Test");
						}, 
						function (msg) {
							$(".mayr-talk span").html("Failed");
						}
					);
				}
			}*/
			$(document).ready(function() {
				$(".login-box").hide();
				$(".reg-box").hide();
				$(".stats").click(function() {
					$(this).toggleClass("stats-open", 500);
					$(".stats-title").toggleHTML("&lt;", "&gt;");
				});
				$(".achieve").click(function() {
					$(this).toggleClass("achieve-open", 500);
					$(".achieve-title").toggleHTML("&lt;", "&gt;");
				});
				$(".login").click(function() {
					$(".login-box").fadeToggle();
					$(".reg-box").hide();
				});
				$(".reg").click(function() {
					$(".reg-box").fadeToggle();
					$(".login-box").hide();
				});
			});
		</script>
	</head>
	<body>
		<div class="short-block header">
			<span class="title"><img src="{% static 'logo.png' %}" />Pixelicity</span>
			<span class="menu"><ul>
				<li><a href="{% url 'index' %}">Home</a></li>
				<li><a href="{% url 'about' %}">About</a></li>
				<li><a href="#">Visit</a></li>
			</ul></span>
			<span class="greeting">{% if user.is_authenticated %}Hello, {{ name }} | <a href="{% url 'logout' %}">Log Out</a>{% else %}<a class="login">Log In</a> | <a class="reg">Register</a>{% endif %}</span>
		</div>
		{% if not user.is_authenticated %}
		<div class="login-box">
			<h1>Log In</h1>
			<form action="{% url 'login' %}" method="post">
				{% csrf_token %}
				Username: <input type="text" name="username" /><br /><br />
				Password: <input type="password" name="password" /><br /><br />
				<input type="submit" value="Log in" />
			</form>
		</div>
		<div class="reg-box">
			<h1>Register</h1>
			<form action="{% url 'register' %}" method="post">
				{% csrf_token %}
				Username: <input type="text" name="username" /><br /><br />
				Password: <input type="password" name="password" /><br /><br />
				Email Address: <input type="text" name="email" /><br /><br />
				Name: <input type="text" name="first" /> <input type="text" name="last" /><br /><br />
				<input type="submit" value="Register" />
			</form>
		</div>
		{% endif %}
		<div class="stats">
			<div class="wrapper"><div class="stats-title">&gt;</div></div>
		</div>
		<div class="achieve">
			<div class="wrapper"><div class="achieve-title">&lt;</div></div>
		</div>
		<div id="map-canvas"></div>
		<div class="mayr"><div class="mayr-box mayr-talk"><span>Mayr says: Welcome to Pixelicity! Why don't you check out our <a href="{% url 'about' %}">about</a> page for more information?</span></div><img src="{% static "mayr-small.png" %}" /></div>
		<div class="short-block footer"></div>
	</body>
</html>